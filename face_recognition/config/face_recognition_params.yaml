# ROS2 Parameters for Face Recognition Node
# This file contains all the configurable parameters for the FaceRecognitionNode

face_recognition_node:
  ros__parameters:
    # Topic Configuration
    input_topic: "/humans/faces/detected"
    output_topic: "/humans/faces/recognized"
    image_input_topic: "/camera/color/image_rect_raw"
    compressed_topic: ""
    
    # Processing Configuration
    processing_rate_hz: 30.0
    device: "cuda:0"
    
    # Face Embedding Model Configuration
    face_embedding_model: "vggface2"
    face_embedding_weights_name: "20180402-114759-vggface2.pt"
    
    # Identity Management Configuration
    similarity_threshold: 0.3
    clustering_threshold: 0.6
    max_embeddings_per_identity: 50  # Reduced from 150 to 50 - fewer comparisons
    identity_timeout: 5.0
    identity_database_path: "src/face_recognition/database/identity_database.json"
    
    # Performance Optimization
    # Percentage of frames to skip face recognition (0-100)
    # When skipping, the last cached recognition result for each face_id is reused
    # For example, 50.0 means recognize every other frame, reusing cached results for skipped frames
    recognition_frame_skip_percentage: 0.0  # Default: 0.0 no skipping (process every frame)
  
    embedding_inclusion_threshold: 0.6  # Threshold for including embeddings in identity cluster (must be >= similarity_threshold)
    track_identity_stickiness_margin: 0.4  # Margin to prevent identity switching
    use_ewma_for_mean: false  # Whether to use EWMA for mean embedding calculation
    ewma_alpha: 0.6  # Learning rate for EWMA (0 < alpha < 1). Higher values adapt faster to new embeddings.

        

    # Debug Configuration
    enable_debug_output: true
    
    # Receiver Configuration
    receiver_id: "face_recognition"
    
    # ROS4HRI Configuration
    ros4hri_with_id: false
